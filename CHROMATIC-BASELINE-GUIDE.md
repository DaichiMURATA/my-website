# Chromatic Baselineç®¡ç†ã‚¬ã‚¤ãƒ‰

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€Chromaticã®baselineç®¡ç†ã®ä»•çµ„ã¿ã¨ã€è¤‡æ•°PRæ™‚ã®å‹•ä½œã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚

## ğŸ¯ Baselineç®¡ç†ã®åŸºæœ¬

### Baselineã¨ã¯

Baselineã¯ã€**è¦–è¦šçš„å·®åˆ†æ¯”è¼ƒã®åŸºæº–ã¨ãªã‚‹ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ**ã§ã™ã€‚Chromaticã¯æ–°ã—ã„ãƒ“ãƒ«ãƒ‰ã‚’ã“ã®baselineã¨æ¯”è¼ƒã—ã¦ã€å¤‰æ›´ã‚’æ¤œå‡ºã—ã¾ã™ã€‚

### Chromaticã®ãƒ–ãƒ©ãƒ³ãƒãƒ™ãƒ¼ã‚¹baseline

Chromaticã¯**ãƒ–ãƒ©ãƒ³ãƒã”ã¨ã«ç‹¬ç«‹ã—ãŸbaseline**ã‚’ç®¡ç†ã—ã¾ã™ï¼š

```
main ãƒ–ãƒ©ãƒ³ãƒ:
  â””â”€ Baseline: main ã®æœ€æ–°æ‰¿èªæ¸ˆã¿ãƒ“ãƒ«ãƒ‰

feature-A ãƒ–ãƒ©ãƒ³ãƒ:
  â””â”€ Baseline: mainãƒ–ãƒ©ãƒ³ãƒã®baselineï¼ˆæœ€åˆï¼‰
  â””â”€ ã¾ãŸã¯: feature-Aã§æ‰¿èªã•ã‚ŒãŸæœ€æ–°ãƒ“ãƒ«ãƒ‰

feature-B ãƒ–ãƒ©ãƒ³ãƒ:
  â””â”€ Baseline: mainãƒ–ãƒ©ãƒ³ãƒã®baselineï¼ˆæœ€åˆï¼‰
  â””â”€ ã¾ãŸã¯: feature-Bã§æ‰¿èªã•ã‚ŒãŸæœ€æ–°ãƒ“ãƒ«ãƒ‰
```

**é‡è¦**: feature-A ã¨ feature-B ã¯**äº’ã„ã«å½±éŸ¿ã—ã¾ã›ã‚“** âœ…

## ğŸ”„ Baselineæ›´æ–°ã®ãƒˆãƒªã‚¬ãƒ¼

### 1. æ‰‹å‹•æ‰¿èªï¼ˆAcceptï¼‰

Chromaticãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ã€ŒAcceptã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸå ´åˆï¼š
- âœ… ãã®ãƒ–ãƒ©ãƒ³ãƒã®baselineãŒæ›´æ–°ã•ã‚Œã‚‹
- âŒ ä»–ã®ãƒ–ãƒ©ãƒ³ãƒã«ã¯å½±éŸ¿ã—ãªã„

```
ä¾‹: feature-A ãƒ–ãƒ©ãƒ³ãƒã§å¤‰æ›´ã‚’æ‰¿èª
  â†’ feature-A ã®baselineãŒæ›´æ–°
  â†’ feature-B ã®baselineã¯å¤‰ã‚ã‚‰ãªã„
  â†’ main ã®baselineã¯å¤‰ã‚ã‚‰ãªã„
```

### 2. è‡ªå‹•æ‰¿èªï¼ˆAuto-acceptï¼‰

`chromatic.config.json` ã® `autoAcceptChanges` è¨­å®šï¼š

```json
{
  "autoAcceptChanges": "main"
}
```

**å‹•ä½œ**:
- âœ… `main` ãƒ–ãƒ©ãƒ³ãƒã«ãƒãƒ¼ã‚¸ã•ã‚ŒãŸå¤‰æ›´ã¯è‡ªå‹•æ‰¿èª
- âœ… `main` ã®baselineãŒè‡ªå‹•æ›´æ–°
- âŒ PRãƒ–ãƒ©ãƒ³ãƒã§ã¯è‡ªå‹•æ‰¿èªã•ã‚Œãªã„

### 3. CLIã‚ªãƒ—ã‚·ãƒ§ãƒ³

ä»¥ä¸‹ã®CLIã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§åˆ¶å¾¡å¯èƒ½ï¼š

| ã‚ªãƒ—ã‚·ãƒ§ãƒ³ | åŠ¹æœ | ä½¿ç”¨å ´é¢ |
|-----------|------|----------|
| `--auto-accept-changes <branch>` | æŒ‡å®šãƒ–ãƒ©ãƒ³ãƒã§è‡ªå‹•æ‰¿èª | CI/CDã§main/developã®ã¿è‡ªå‹•æ‰¿èª |
| `--only-changed` | å¤‰æ›´ã•ã‚ŒãŸã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã®ã¿ãƒ†ã‚¹ãƒˆ | å¤§è¦æ¨¡ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®é«˜é€ŸåŒ– |
| `--exit-zero-on-changes` | å¤‰æ›´ãŒã‚ã£ã¦ã‚‚exit 0 | CI/CDã§å¤±æ•—æ‰±ã„ã«ã—ãªã„ |
| `--exit-once-uploaded` | ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¾Œã™ãçµ‚äº† | ãƒ“ãƒ«ãƒ‰æ™‚é–“çŸ­ç¸®ï¼ˆçµæœã¯éåŒæœŸï¼‰ |

## ğŸ”€ è¤‡æ•°PRæ™‚ã®ã‚·ãƒŠãƒªã‚ª

### ã‚·ãƒŠãƒªã‚ª1: 2ã¤ã®PRãŒåŒæ™‚é€²è¡Œ

```
main (baseline: Build 1)
  â”œâ”€ feature-A (PR #1)
  â”‚   â”œâ”€ Build 2: main (Build 1) ã¨æ¯”è¼ƒ
  â”‚   â””â”€ Build 3: main (Build 1) ã¨æ¯”è¼ƒ â† feature-Aã®æœ€æ–°ãƒ“ãƒ«ãƒ‰
  â”‚
  â””â”€ feature-B (PR #2)
      â”œâ”€ Build 4: main (Build 1) ã¨æ¯”è¼ƒ
      â””â”€ Build 5: main (Build 1) ã¨æ¯”è¼ƒ â† feature-Bã®æœ€æ–°ãƒ“ãƒ«ãƒ‰
```

**é‡è¦ãƒã‚¤ãƒ³ãƒˆ**:
- âœ… Build 2ã¨Build 3ã¯**feature-Aã®å¤‰æ›´ã®ã¿**ã‚’æ¤œå‡º
- âœ… Build 4ã¨Build 5ã¯**feature-Bã®å¤‰æ›´ã®ã¿**ã‚’æ¤œå‡º
- âœ… äº’ã„ã«å½±éŸ¿ã—ãªã„

### ã‚·ãƒŠãƒªã‚ª2: feature-Aã§å¤‰æ›´ã‚’æ‰¿èªã—ãŸå ´åˆ

```
feature-A (PR #1) ã§å¤‰æ›´ã‚’æ‰¿èª:
  â†’ feature-Aã®baseline: Build 2 â†’ Build 3 ã«æ›´æ–°
  â†’ mainã®baseline: Build 1 (å¤‰ã‚ã‚‰ãš)
  â†’ feature-Bã®baseline: Build 1 (å¤‰ã‚ã‚‰ãš)
```

**çµæœ**:
- âœ… feature-Aã®æ¬¡ã®ãƒ“ãƒ«ãƒ‰ï¼ˆBuild 6ï¼‰ã¯ã€Build 3ã¨æ¯”è¼ƒ
- âœ… feature-Bã¯å¼•ãç¶šãmain (Build 1)ã¨æ¯”è¼ƒ
- âœ… baselineãŒæ··ã–ã‚‰ãªã„

### ã‚·ãƒŠãƒªã‚ª3: feature-Aã‚’mainã«ãƒãƒ¼ã‚¸ã—ãŸã¨ã

```
feature-A â†’ main ãƒãƒ¼ã‚¸:
  â†’ mainã®baseline: Build 1 â†’ Build 7 ã«æ›´æ–°ï¼ˆè‡ªå‹•æ‰¿èªè¨­å®šã«ã‚ˆã‚‹ï¼‰
  â†’ feature-Bã®æ¬¡ã®ãƒ“ãƒ«ãƒ‰: æ–°ã—ã„main (Build 7) ã¨æ¯”è¼ƒ

æ–°ã—ã„PR (feature-C):
  â†’ mainã®æœ€æ–°baseline (Build 7) ã¨æ¯”è¼ƒ
```

**çµæœ**:
- âœ… mainã®baselineãŒæœ€æ–°ã«æ›´æ–°ã•ã‚Œã‚‹
- âœ… æœªãƒãƒ¼ã‚¸ã®PRã¯ã€æ–°ã—ã„mainã¨æ¯”è¼ƒã™ã‚‹ã‚ˆã†ã«ãªã‚‹
- âš ï¸ feature-Bã§ç«¶åˆã™ã‚‹å¤‰æ›´ãŒã‚ã‚‹å ´åˆã€å·®åˆ†ã¨ã—ã¦æ¤œå‡ºã•ã‚Œã‚‹

## âš™ï¸ my-websiteãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®š

### chromatic.config.json

```json
{
  "$schema": "https://www.chromatic.com/config-file.schema.json",
  "projectId": "Project:69606830af12af0596be2ea1",
  "autoAcceptChanges": "main",
  "exitZeroOnChanges": true,
  "exitOnceUploaded": false
}
```

**è¨­å®šã®æ„å‘³**:

1. **`autoAcceptChanges: "main"`**:
   - **mainãƒ–ãƒ©ãƒ³ãƒã®ãƒ“ãƒ«ãƒ‰ã®ã¿è‡ªå‹•æ‰¿èª**
   - PRãƒ–ãƒ©ãƒ³ãƒã§ã¯è‡ªå‹•æ‰¿èªã•ã‚Œãªã„
   - â†’ PRã§baselineãŒå‹æ‰‹ã«æ›´æ–°ã•ã‚Œã‚‹ã“ã¨ã¯ãªã„ âœ…
   - ã“ã‚Œã«ã‚ˆã‚Šã€è¤‡æ•°PRãŒç«‹ã£ã¦ã‚‚äº’ã„ã«å½±éŸ¿ã—ãªã„

2. **`exitZeroOnChanges: true`**:
   - **è¦–è¦šçš„å¤‰æ›´ãŒã‚ã£ã¦ã‚‚CI/CDã‚’æˆåŠŸæ‰±ã„**
   - â†’ PRãŒãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œãªã„
   - è¦–è¦šçš„å¤‰æ›´ãŒæ¤œå‡ºã•ã‚Œã¦ã‚‚exit code 0ã§çµ‚äº†

3. **`exitOnceUploaded: false`**:
   - **ãƒ†ã‚¹ãƒˆå®Œäº†ã¾ã§å¾…æ©Ÿ**
   - â†’ çµæœãŒPRã‚³ãƒ¡ãƒ³ãƒˆã«åæ˜ ã•ã‚Œã‚‹
   - trueã«ã™ã‚‹ã¨ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã®ã¿ã§çµ‚äº†ï¼ˆé«˜é€Ÿã ãŒçµæœãŒPRã«åæ˜ ã•ã‚Œãªã„ï¼‰

### æ¨å¥¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

#### PRä½œæˆæ™‚ï¼ˆfeature ãƒ–ãƒ©ãƒ³ãƒï¼‰
```yaml
- name: Upload to Chromatic
  run: npx chromatic --playwright
  # è¨­å®šã«ã‚ˆã‚Š:
  # - mainã®baselineã¨æ¯”è¼ƒ
  # - å¤‰æ›´ã¯è‡ªå‹•æ‰¿èªã•ã‚Œãªã„
  # - æ‰‹å‹•ã§Accept/RejectãŒå¿…è¦
```

#### mainãƒãƒ¼ã‚¸æ™‚
```yaml
- name: Upload to Chromatic
  if: github.ref == 'refs/heads/main'
  run: npx chromatic --playwright
  # è¨­å®šã«ã‚ˆã‚Š:
  # - è‡ªå‹•æ‰¿èªã•ã‚Œã‚‹ (autoAcceptChanges: "main")
  # - mainã®baselineãŒæ›´æ–°ã•ã‚Œã‚‹
```

## ğŸ¯ ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 1. mainãƒ–ãƒ©ãƒ³ãƒã®ã¿è‡ªå‹•æ‰¿èª

```json
{
  "autoAcceptChanges": "main"
}
```

**ç†ç”±**:
- PRãƒ–ãƒ©ãƒ³ãƒã§ã¯æ‰¿èªã‚’å¿…é ˆã«ã™ã‚‹
- mainã«ãƒãƒ¼ã‚¸ã•ã‚ŒãŸå¤‰æ›´ã®ã¿baselineåŒ–
- å®‰å…¨æ€§ã¨ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ—ãƒ­ã‚»ã‚¹ã®ç¢ºä¿

### 2. developãƒ–ãƒ©ãƒ³ãƒã‚‚ä¿è­·ã™ã‚‹å ´åˆ

```json
{
  "autoAcceptChanges": ["main", "develop"]
}
```

**ä½¿ç”¨å ´é¢**:
- developãƒ–ãƒ©ãƒ³ãƒã‚‚ä¿è­·ã—ãŸã„å ´åˆ
- featureãƒ–ãƒ©ãƒ³ãƒã¯æ‰‹å‹•æ‰¿èªå¿…é ˆ

### 3. ç‰¹å®šã®ãƒ–ãƒ©ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ã‚¹ã‚­ãƒƒãƒ—

```json
{
  "skip": ["dependabot/**", "renovate/**"]
}
```

**ç†ç”±**:
- ä¾å­˜é–¢ä¿‚æ›´æ–°PRã¯ã‚¹ã‚­ãƒƒãƒ—
- ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆæ•°ã®ç¯€ç´„

### 4. PRã”ã¨ã«æ‰‹å‹•ãƒ¬ãƒ“ãƒ¥ãƒ¼

```yaml
# GitHub Actions
- name: Upload to Chromatic
  run: npx chromatic --playwright
  # --auto-accept-changesã‚’æŒ‡å®šã—ãªã„
  # â†’ Chromaticãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§æ‰‹å‹•æ‰¿èª
```

**ç†ç”±**:
- ã™ã¹ã¦ã®UIå¤‰æ›´ã‚’ãƒ¬ãƒ“ãƒ¥ãƒ¼
- æ„å›³ã—ãªã„å¤‰æ›´ã®æ¤œå‡º
- ãƒãƒ¼ãƒ å…¨ä½“ã§ã®ç¢ºèª

## ğŸ” ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### Q1: PRãƒ–ãƒ©ãƒ³ãƒã§baselineãŒæ›´æ–°ã•ã‚Œã¦ã—ã¾ã†

**åŸå› **: `autoAcceptChanges` ãŒè¨­å®šã•ã‚Œã¦ã„ãªã„ã€ã¾ãŸã¯åºƒã™ãã‚‹

**è§£æ±ºç­–**:
```json
{
  "autoAcceptChanges": "main"  // mainã®ã¿ã«é™å®š
}
```

### Q2: è¤‡æ•°PRã§äº’ã„ã«å½±éŸ¿ã—åˆã£ã¦ã„ã‚‹

**åŸå› **: ã“ã‚Œã¯é€šå¸¸èµ·ã“ã‚Šã¾ã›ã‚“ã€‚ãƒ–ãƒ©ãƒ³ãƒã¯ç‹¬ç«‹ã—ã¦ã„ã¾ã™ã€‚

**ç¢ºèªæ–¹æ³•**:
1. Chromaticãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§å„ãƒ“ãƒ«ãƒ‰ã®ã€ŒBaselineã€ã‚’ç¢ºèª
2. ã©ã®ãƒ“ãƒ«ãƒ‰ã¨æ¯”è¼ƒã—ã¦ã„ã‚‹ã‹ç¢ºèª

**æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ**:
- feature-A: mainã®æœ€æ–°baselineã¨æ¯”è¼ƒ
- feature-B: mainã®æœ€æ–°baselineã¨æ¯”è¼ƒ

### Q3: mainãƒãƒ¼ã‚¸å¾Œã€ä»–ã®PRã§å¤§é‡ã®å·®åˆ†ãŒå‡ºã‚‹

**åŸå› **: ã“ã‚Œã¯æ­£å¸¸ã§ã™ã€‚mainã®baselineãŒæ›´æ–°ã•ã‚ŒãŸãŸã‚ã€‚

**å¯¾å‡¦æ³•**:
1. å„PRã‚’æœ€æ–°ã®mainã«rebase/merge
2. æ–°ã—ã„mainã¨ã®å·®åˆ†ã‚’ç¢ºèª
3. ç«¶åˆãŒã‚ã‚Œã°Accept

```bash
# feature-Bãƒ–ãƒ©ãƒ³ãƒã§
git fetch origin
git rebase origin/main  # ã¾ãŸã¯ merge
git push --force-with-lease
# â†’ ChromaticãŒæ–°ã—ã„mainã¨æ¯”è¼ƒ
```

## ğŸ“Š Baselineã®ç¢ºèªæ–¹æ³•

### Chromaticãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰

1. ãƒ“ãƒ«ãƒ‰ãƒšãƒ¼ã‚¸ã‚’é–‹ã
2. ã€ŒBaselineã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç¢ºèª
3. ã©ã®ãƒ“ãƒ«ãƒ‰ã¨æ¯”è¼ƒã—ã¦ã„ã‚‹ã‹ç¢ºèª

ä¾‹:
```
Build 5 (feature-B)
  â†“ compared to
Baseline: Build 1 (main)
```

### CLIå‡ºåŠ›

Chromaticã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ™‚ã®ãƒ­ã‚°ï¼š
```
Retrieved git information
  â†’ Commit 'abc123' on branch 'feature-A'
  â†’ Found baseline: Build 1 on main
```

## ğŸ“ ã¾ã¨ã‚

### âœ… å®‰å…¨ãªBaselineç®¡ç†

1. **mainãƒ–ãƒ©ãƒ³ãƒã®ã¿è‡ªå‹•æ‰¿èª**:
   ```json
   { "autoAcceptChanges": "main" }
   ```

2. **PRã§ã¯æ‰‹å‹•æ‰¿èªå¿…é ˆ**:
   - Chromaticãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ãƒ¬ãƒ“ãƒ¥ãƒ¼
   - æ„å›³ã—ãŸå¤‰æ›´ã®ã¿Accept

3. **ãƒ–ãƒ©ãƒ³ãƒç‹¬ç«‹æ€§**:
   - å„PRã¯ç‹¬è‡ªã®ãƒ“ãƒ«ãƒ‰å±¥æ­´ã‚’æŒã¤
   - äº’ã„ã«å½±éŸ¿ã—ãªã„

4. **mainãƒãƒ¼ã‚¸ã§baselineæ›´æ–°**:
   - ãƒ¬ãƒ“ãƒ¥ãƒ¼æ¸ˆã¿ã®å¤‰æ›´ã®ã¿baselineåŒ–
   - æ–°ã—ã„PRã¯æœ€æ–°ã®mainã¨æ¯”è¼ƒ

### âš ï¸ æ³¨æ„ç‚¹

- PRãƒ–ãƒ©ãƒ³ãƒã§ã€ŒAcceptã€ã™ã‚‹ã¨ã€ãã®ãƒ–ãƒ©ãƒ³ãƒã®baselineãŒæ›´æ–°ã•ã‚Œã‚‹
- mainã«ãƒãƒ¼ã‚¸å¾Œã€ä»–ã®PRã¯æ–°ã—ã„mainã¨æ¯”è¼ƒã•ã‚Œã‚‹ï¼ˆã“ã‚Œã¯æ­£å¸¸ï¼‰
- ä¾å­˜é–¢ä¿‚ã®æ›´æ–°ãªã©ã€ä¸è¦ãªãƒ“ãƒ«ãƒ‰ã¯ `skip` ãƒ‘ã‚¿ãƒ¼ãƒ³ã§é™¤å¤–

---

**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**: my-website  
**Chromatic Project ID**: 69606830af12af0596be2ea1  
**æ›´æ–°æ—¥**: 2026-01-09

